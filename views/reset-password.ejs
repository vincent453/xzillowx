<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reset Password</title>
    <link rel="stylesheet" href="/css/auth.css"> <!-- ✅ Link CSS -->
</head>
<body>
    <div class="auth-container">
        <h2>Reset Password</h2>
        <form id="reset-password-form">
            <input type="password" id="password" placeholder="Enter new password" required>
            <p id="password-strength"></p>
            <button type="submit">Reset Password</button>
            <p id="message"></p>
        </form>
    </div>

    <script>
        document.getElementById("reset-password-form").addEventListener("submit", async function(event) {
            event.preventDefault();
            const password = document.getElementById("password").value;
            const messageBox = document.getElementById("message");

            // ✅ Get token from URL
            const token = window.location.pathname.split("/").pop();

            const response = await fetch(`/api/auth/reset-password/${token}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ password })
            });

            const data = await response.json();
            messageBox.textContent = data.message || data.error;

            if (response.ok) {
                alert("✅ Password reset successfully! Redirecting to login...");
                window.location.href = "/signup";
            }
        });
        document.getElementById("password").addEventListener("input", function () {
            const password = this.value;
            const strengthText = document.getElementById("password-strength");
            const submitBtn = document.getElementById("submit-btn");

            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[\W_]/.test(password)) strength++;

            if (strength < 2) {
                strengthText.textContent = "Weak Password ❌";
                strengthText.style.color = "red";
                submitBtn.disabled = true;
            } else if (strength < 4) {
                strengthText.textContent = "Moderate Password ⚠️";
                strengthText.style.color = "orange";
                submitBtn.disabled = false;
            } else {
                strengthText.textContent = "Strong Password ✅";
                strengthText.style.color = "green";
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
